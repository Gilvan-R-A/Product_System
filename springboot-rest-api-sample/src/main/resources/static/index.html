<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
	crossorigin="anonymous">

<style type="text/css">
html {
	margin-left: 5%;
	margin-right: 5%;
	margin-top: 5%;
}
#valor {
	margin-bottom: 30px;
}

</style>
<title>Cadastro de Produtos</title>
</head>

<body>

	<main>
	<h3>Cadastro de Produtos</h3>

	<form action="" id="formCadastroProduto">

		<div class="mb-3">
		
			<label for="id" class="form-label">ID</label>
			<input type="text" class="form-control" id="id" readonly="readonly">
			 
			<label for="nomeProduto" class="form-label">Nome do Produto</label>
			<input type="text" class="form-control" id="nomeProduto" placeholder="Informe o nome">

			<label for="descricao" class="form-label">Descrição</label> 
			<input type="text" class="form-control" id="descricao">
			
			<label for="valor" class="form-label">Valor</label>
			<input type="number" class="form-control" id="valor">
			
		 	<select class="form-select" id="disponivel">
  				<option selected>Disponível para venda?</option>
  				<option value= 1>Sim</option>
  				<option value= 2>Não</option>
			</select>
	
		</div>

	</form>
	
	<button type="button" onclick="salvarProduto()" class="btn btn-primary">Salvar</button>
	<button type="button" onclick="document.getElementById('formCadastroProduto').reset()" class="btn btn-secondary">Novo</button>

	</main>
		
	<script type="text/javascript">
	
	function salvarProduto(){	
		var id = $("#id").val();
		var nome = $("#nomeProduto").val();
		var descricao = $("#descricao").val();
		var valor = $("#valor").val();
		var disponivel = $("#disponivel option:selected").val();
			
		switch(disponivel){
		case '1':
			disponivel = true; 
			break;
		case '2':
			disponivel = false; 
			break;
			default:
			alert("Algo deu errado!");
			break;
		}
		
		   $.ajax({
			   method: "POST",
			   url: "salvar",
			   data: JSON.stringify({id: id, nome: nome, descricao: descricao, valor: valor, disponivel: disponivel}),
			   contentType: "application/json; charset=utf-8",
			   success: function(response){
			$("#id").val(response.id);
			alert("Gravou com sucesso!");
			}
			}).fail(function(xhr, status, errorThrown){
			alert("Erro ao salvar produto" +xhr.responseText);
			});
			
	}
	

	
	</script>
	
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"
		integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
		crossorigin="anonymous"></script>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
		crossorigin="anonymous"></script>
</body>
</html>